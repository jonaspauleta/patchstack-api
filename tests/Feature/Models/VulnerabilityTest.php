<?php

use App\Models\User;
use App\Models\Vulnerability;

it('can retrieve factors for a vulnerability', function () {
    $vulnerability = Vulnerability::factory()->create();

    expect($vulnerability->factors()->count())->toBe(0);

    $vulnerability->factors()->createMany([
        ['name' => 'Factor 1', 'value' => 1],
        ['name' => 'Factor 2', 'value' => 2],
        ['name' => 'Factor 3', 'value' => 3],
    ]);

    expect($vulnerability->factors()->count())->toBe(3);
});

it('can retrieve the user associated with a vulnerability', function () {
    $user = User::factory()->create();
    $vulnerability = Vulnerability::factory()->create(['user_id' => $user->id]);

    expect($vulnerability->user->id)->toBe($user->id);
});
